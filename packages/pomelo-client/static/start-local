#!/usr/bin/env node

"use strict";

const debug = require("debug")("pomelo-client:start-local");
const gracefulExit = require("graceful-process");
const { SSLocal } = require("pomelo");
const options = JSON.parse(process.argv[2]);
debug("start local options: %j", options);

const sslocal = new SSLocal(options);
sslocal.start().catch(ex => {
  sslocal.logger.error(ex);
  process.exit(1);
});

gracefulExit({
  beforeExit: () => sslocal.close(),
  label: "ss-local",
  logger: SSLocal.logger,
});
